{% extends "layout.html" %}
{% block content %}

<form method="POST" action="{{ url_for('book_appointment_form') }}">
  <input type="hidden" name="date" id="selected_date">
  <input type="hidden" name="time" id="selected_time">
  <input type="hidden" name="dokter_id" id="selected_dokter">

<section class="py-16 px-4 max-w-5xl mx-auto min-h-screen text-white">
  <div class="bg-[#0B0E14] rounded-2xl p-6 md:p-10 border border-white/5">

    <!-- Header -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
      <div>
        <a href="{{ url_for('home') }}" class="inline-flex items-center gap-2 text-sm text-[#7DA0CA] hover:text-white mb-3">
          ← Back to Doctors
        </a>
        <h2 class="text-3xl font-bold">Schedule Appointment</h2>
        <p class="text-[#7DA0CA] text-sm mt-1">Choose your preferred date & time</p>
      </div>
    </div>

    <!-- Select Doctor -->
    <div class="mb-8">
      <h3 class="text-lg font-semibold mb-3">Select Doctor</h3>
      <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
        {% for d in dokter_list %}
        <button type="button"
          onclick="selectDoctor('{{ d.dokter_id }}', this)"
          class="py-3 px-4 bg-[#161B22] border border-white/5 rounded-lg text-sm text-[#7DA0CA]
                 hover:text-white hover:border-[#2F80ED] transition doctor-btn">
          {{ d.nama_depan }} {{ d.nama_belakang }}
        </button>
        {% endfor %}
      </div>
    </div>

    <!-- Select Date -->
    <div class="mb-8">
      <h3 class="text-lg font-semibold mb-3">Select Date</h3>
      <div class="flex gap-3 overflow-x-auto pb-2 scrollbar-hide">
        {% set dates = [
          ('2025-12-15','Mon','15'),
          ('2025-12-16','Tue','16'),
          ('2025-12-17','Wed','17'),
          ('2025-12-18','Thu','18'),
          ('2025-12-19','Fri','19'),
          ('2025-12-20','Sat','20')
        ] %}
        {% for full, day, date in dates %}
        <button type="button"
          onclick="selectDate('{{ full }}', this)"
          class="flex-none w-20 h-24 rounded-xl bg-[#161B22] border border-white/5
                 text-[#7DA0CA] hover:border-[#2F80ED] hover:text-white transition date-btn">
          <span class="text-sm">{{ day }}</span>
          <span class="text-2xl font-bold text-white">{{ date }}</span>
        </button>
        {% endfor %}
      </div>
    </div>

    <!-- Select Time -->
    <div class="mb-8">
      <h3 class="text-lg font-semibold mb-3">Select Time</h3>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
        {% for time in ['8:00 AM','9:30 AM','11:00 AM','1:00 PM','2:00 PM','3:00 PM','4:30 PM'] %}
        <button type="button"
          onclick="selectTime('{{ time }}', this)"
          class="py-3 px-4 bg-[#161B22] border border-white/5 rounded-lg
                 text-sm text-[#7DA0CA] hover:text-white hover:border-[#2F80ED]
                 transition time-btn">
          {{ time }}
        </button>
        {% endfor %}
      </div>
    </div>

    <!-- Footer -->
    <div class="pt-6 border-t border-white/5 flex flex-col md:flex-row items-center justify-between gap-4">
      <div>
        <p class="text-sm text-[#7DA0CA]">Selected:</p>
        <p class="font-semibold">
          <span id="show_date">-</span>
          <span class="mx-1">•</span>
          <span id="show_time" class="text-[#2F80ED]">-</span>
        </p>
      </div>

      <button type="submit"
        class="w-full md:w-auto px-8 py-3 rounded-lg bg-[#2F80ED]
               font-semibold hover:bg-blue-600 transition">
        Confirm Appointment
      </button>
    </div>

  </div>
</section>
</form>

<style>
.scrollbar-hide::-webkit-scrollbar { display: none; }
.scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
</style>

<script>
function clearActive(cls) {
  document.querySelectorAll('.' + cls).forEach(btn => {
    btn.classList.remove('bg-[#2F80ED]', 'text-white', 'font-bold');
    btn.classList.add('bg-[#161B22]', 'text-[#7DA0CA]');
  });
}

function selectDoctor(id, el) {
  document.getElementById('selected_dokter').value = id;
  clearActive('doctor-btn');
  el.classList.add('bg-[#2F80ED]', 'text-white', 'font-bold');
}

function selectDate(date, el) {
  document.getElementById('selected_date').value = date;
  document.getElementById('show_date').innerText = date;
  clearActive('date-btn');
  el.classList.add('bg-[#2F80ED]', 'text-white', 'font-bold');
}

function selectTime(time, el) {
  document.getElementById('selected_time').value = time;
  document.getElementById('show_time').innerText = time;
  clearActive('time-btn');
  el.classList.add('bg-[#2F80ED]', 'text-white', 'font-bold');
}
</script>

{% endblock %}
